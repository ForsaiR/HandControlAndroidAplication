package com.handcontrol

import com.handcontrol.server.protobuf.Gestures
import org.junit.Assert
import org.junit.Test

class BluetoothHandlerTest {

    @Test
    fun getGesturesTest() {
        fun byteArrayOfInts(vararg ints: Int) = ByteArray(ints.size) { pos -> ints[pos].toByte() }
        val arr = byteArrayOfInts(0x08, 0xdb, 0xa3, 0xd3, 0x84, 0x06, 0x12, 0x36, 0x0a, 0x03,
            0x0a, 0x01, 0x31, 0x12, 0x0c, 0x6e, 0x61, 0x6d, 0x65, 0x5f, 0x67, 0x65, 0x73, 0x74,
            0x75, 0x72, 0x65, 0x18, 0x9b, 0x01, 0x20, 0x01, 0x28, 0x06, 0x32, 0x0c, 0x08, 0x01,
            0x10, 0x01, 0x18, 0x01, 0x20, 0x01, 0x28, 0x01, 0x30, 0x01, 0x32, 0x0c, 0x08, 0x02,
            0x10, 0x02, 0x18, 0x02, 0x20, 0x02, 0x28, 0x02, 0x30, 0x01, 0x12, 0x36, 0x0a, 0x03,
            0x0a, 0x01, 0x32, 0x12, 0x0c, 0x6e, 0x61, 0x6d, 0x65, 0x5f, 0x67, 0x65, 0x73, 0x74,
            0x75, 0x72, 0x65, 0x18, 0x9b, 0x01, 0x20, 0x01, 0x28, 0x06, 0x32, 0x0c, 0x08, 0x01,
            0x10, 0x01, 0x18, 0x01, 0x20, 0x01, 0x28, 0x01, 0x30, 0x01, 0x32, 0x0c, 0x08, 0x02,
            0x10, 0x02, 0x18, 0x02, 0x20, 0x02, 0x28, 0x02, 0x30, 0x01)

        var confirmed = 0

        for (gesture in Gestures.GetGestures.parseFrom(arr).gesturesList) {
            if (gesture.id.value == "1" || gesture.id.value == "2") {
                confirmed += 1
            }
        }

        Assert.assertEquals(2, confirmed)
    }
}